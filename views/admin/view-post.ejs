<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
	    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    	<meta name="viewport" content="width=device-width, initial-scale=1">
		<link rel="stylesheet" href="/css/bootstrap.css" type="text/css">
		<link rel="stylesheet" href="/css/all.css" type="text/css">
		<link rel="stylesheet" href="/css/admin_style2.css" type="text/css">
        <title>Admin || View Post</title>
	</head>
	<body>
		<div class="header">
			<div class="logo">
				<img src="/img/PN LOGO 2.png" alt="PN">
				<span>parrot news</span>
			</div>
			<a href="#" class="nav-trigger" id="nav-trigger"><i class="fa fa-bars"></i></a>
		</div>

		<div class="side-nav" id="side-nav">
			<nav>
				<ul>
					<li>
						<a href="/admin/dashboard">
							<span><i class="fa fa-chart-line"></i></span>
							<span>Analysis</span>
						</a>
					</li>
					<li>
						<a href="#" class="sub-menu" id="sub-menu-category">
							<span><i class="fa fa-adjust"></i></span>
							<span>Manage Categories</span>
							<span><i class="fa fa-chevron-down"></i></span>
						</a>
						<div class="sub-category" id="category-sub">
							<ul>
								<li>
									<a href="/admin/add-category" class="">New category</a>
								</li>
								<li>
									<a href="/admin/all-category" class="">All category</a>
								</li>
								<li>
									<a href="/admin/category-actions" class="">Edit/Delete category</a>
								</li>
							</ul>
						</div>
					</li>
					<li>
						<a href="#" class="sub-menu" id="sub-menu-user">
							<span><i class="fa fa-user-alt"></i></span>
							<span>Manage Users</span>
							<span><i class="fa fa-chevron-down"></i></span>
						</a>
						<div class="sub-category" id="user-sub">
							<ul>
								<li>
									<a href="/admin/add-user" class="">Create new user</a>
								</li>
								<li>
									<a href="/admin/all-user" class="">All Users</a>
								</li>
								<li>
									<a href="/admin/assign-role" class="">Assign/Change admin role</a>
								</li>
							</ul>
						</div>
					</li>
					<li class="sym-active">
						<a href="#" class="sub-menu" id="sub-menu-post">
							<span><i class="fa fa-edit"></i></span>
							<span>Manage Post</span>
							<span><i class="fa fa-chevron-down"></i></span>
						</a>
						<div class="sub-category" id="post-sub">
							<ul>
								<li>
									<a href="/admin/new-post" class="">Create post</a>
								</li>
								<li>
									<a href="/admin/all-post" class="">View all post</a>
								</li>
							</ul>
						</div>
					</li>
					<li>
						<a href="/logout" class="sub-menu" id="sub-menu-post">
							<span><i class="fa fa-power-off"></i></span>
							<span>Logout</span>
						</a>
					</li>
				</ul>
			</nav>
		</div>

		<div class="main-content">
			<div class="container mt-5">
				<div class="row">
                    <div class="col-sm-12 col-md-10">
						<% if (success != '') { %>
							<div class="alert alert-success alert-dismissible fade show my-3" role="alert">
							  <%= success %>
							  <button type="button" class="close" data-dismiss="alert" aria-label="Close">
								<span aria-hidden="true">&times;</span>
							  </button>
							</div>
						<% } %>
						<% if (failure != '') { %>
							<div class="alert alert-danger alert-dismissible fade show my-3" role="alert">
							  <%= failure %>
							  <button type="button" class="close" data-dismiss="alert" aria-label="Close">
								<span aria-hidden="true">&times;</span>
							  </button>
							</div>
						<% } %>
                        <% if (typeof post != 'undefined') { %>
							<h1 class="text-capitalize"><%= post.title %></h1>
                        	<p class="lead">by <a href="#" class="card-link"><%= post.user.username %></a></p>
                        	<p class="lead">Posted on <%= moment(post.createdAt).format('DD MMM YYYY, h:mm a') %></p>
                        	<p class="lead">Last modified on <%= moment(post.updatedAt).format('DD MMM YYYY, h:mm a') %></p>
                        	<hr>
                        	<p class="lead text-justify"><%= post.body %></p>
							<h5>Actions: 
								<a href="/admin/edit-post/<%= post._id %>"><i class="fa fa-edit" title="Modify Post"></i></a> 
								<form action="/admin/delete-post/<%= post._id %>" method="post" class="delete-form">
									<button class="delete-btn" title="Delete Post" onclick="return confirm('Are you sure you want to delete this post?')"><i class="fa fa-trash text-danger"></i></button>
								</form>
							</h5>
                        	<hr>
						<% } else { %>
								<h1 class="">No Post Found!!!</h1>
						<% } %>
						<h3 class="text-center">All Comments</h3>
                        	<div class="">
                            	<% if (comments.length != 0) { %>
									<% comments.forEach((comment) => { %>
									  <div class="media-body">
										<h6 class="mt-0"> comment by <%= comment.user.username %> on <%= moment(comment.createdAt).format('ll') %> at <%= moment(comment.createdAt).format('LT') %></h6>
										<p class="text-dark"><%= comment.body %></p>
										<form action="/admin/delete-comment/<%= comment._id %>"" method="POST" class="delete-form">
											<button class="delete-btn" title="Delete Post" onclick="return confirm('Are you sure you want to delete this comment?')"><i class="fa fa-trash text-danger"></i></button>
										</form>
									  </div>
									<% }) %>
								  <% } else { %>
									<h5 class="text-dark card-text">No Comments yet.</h5>
								  <% } %>  
                        	</div>
                    </div>
                </div>
			</div>
		</div>
		<script src="/js/jquery-3.5.1.min.js" type="text/javascript"></script>
		<script src="/js/bootstrap.js" type="text/javascript"></script>
		<script src="/js/main.js" type="text/javascript"></script>
	</body>
</html>